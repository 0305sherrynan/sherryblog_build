import{d as S,u as b,y as L,w as Z,c as d,e as j,f as R,j as e,i as o,x as i,C as y,D as P,E as V,p as T,l as A,G as q,k as $,r as N,g as I,v as C,T as E}from"./index-dd2ca572.js";import{v as O,j as G,r as H}from"./user-8d772601.js";import{r as J}from"./randomId-0019d5c4.js";import"./index-fc906e2e.js";const z=n=>function(u){return n.test(u)},B=z(/^[a-zA-Z0-9]+([-_.][A-Za-zd]+)*@([a-zA-Z0-9]+[-.])+[A-Za-zd]{2,5}$/),D=z(/^1\d{10}$/),f=n=>(T("data-v-0b2649e0"),n=n(),A(),n),K={class:"login"},M={class:"login-left"},Q=f(()=>e("section",{class:"login-left-title"},[e("h2",null,"Welcome Login"),e("p",null,"We're so excited to see you again!")],-1)),X=f(()=>e("span",null,"Email or phone number",-1)),Y=f(()=>e("span",null,"Password",-1)),ee=f(()=>e("a",{href:""},"Forget your password",-1)),te=f(()=>e("div",{class:"login-right"},"123",-1)),se=S({__name:"Login",emits:["clickSignUp"],setup(n,{emit:u}){const r=new q,_=b(),s=L({email:"",password:""});Z(()=>s,(c,a)=>{console.log(c)});const U={email:[{required:!0,validator:async(c,a)=>a===""?Promise.reject("Please input the email"):!B(a)&&!D(a)?Promise.reject("请输入正确的邮箱格式"):Promise.resolve(),trigger:"change"}],password:[{validator:async(c,a)=>a===""?Promise.reject("Please input the password"):a.length>30?Promise.reject("请输入小于长度为30的密码"):Promise.resolve(),trigger:"change"}]},k=()=>{_.push({name:"entrance",params:{operate:"register"}}),u("clickSignUp")},h=async()=>{const{data:c}=await O(s);c.message=="error"?P.error("账号或者密码错误！"):(P.success("验证成功"),r.setItem(V.Local,"token",c.token),_.push({name:"master"}))},w=()=>{console.log("error")};return(c,a)=>{const t=d("a-input"),l=d("a-form-item"),m=d("a-button"),x=d("a-form");return j(),R("div",K,[e("div",M,[Q,o(x,{class:"form",model:s,rules:U,ref:"formRef",name:"custom-validation",onFinish:h,onFinishFailed:w},{default:i(()=>[e("div",null,[X,o(l,{name:"email","has-feedback":""},{default:i(()=>[o(t,{value:s.email,"onUpdate:value":a[0]||(a[0]=p=>s.email=p),type:"text",placeholder:"请输入邮箱"},null,8,["value"])]),_:1})]),e("div",null,[Y,o(l,{name:"password","has-feedback":""},{default:i(()=>[o(t,{value:s.password,"onUpdate:value":a[1]||(a[1]=p=>s.password=p),type:"password",placeholder:"请输入最大长度为30的密码"},null,8,["value"])]),_:1}),ee]),o(m,{type:"primary","html-type":"submit"},{default:i(()=>[y("Submit")]),_:1}),e("span",{class:"login-left-lastSpan"},[y("Don't have an account?"),e("a",{onClick:k},"Sign up")])]),_:1},8,["model"])]),te])}}});const ae=$(se,[["__scopeId","data-v-0b2649e0"]]),v=n=>(T("data-v-83885e91"),n=n(),A(),n),oe={class:"login"},ne={class:"login-left"},re=v(()=>e("section",{class:"login-left-title"},[e("h2",null,"Welcome Register"),e("p",null,"We're so excited to see you again!")],-1)),ie=v(()=>e("span",null,"Email ",-1)),le=v(()=>e("span",null,"Password",-1)),ce=v(()=>e("span",null,"NickName",-1)),de=v(()=>e("div",{class:"login-right"},"123",-1)),ue=S({__name:"Register",emits:["clickSignUp"],setup(n,{emit:u}){const r=N(),_=b(),s=L({user_id:"",password:"",nickname:"",email:""}),k={email:[{required:!0,validator:async(a,t)=>t===""?Promise.reject("Please input the email"):!B(t)&&!D(t)?Promise.reject("请输入正确的邮箱格式"):Promise.resolve(),trigger:"change"}],password:[{validator:async(a,t)=>t===""?Promise.reject("Please input the password"):t.length>30?Promise.reject("请输入小于长度为30的密码"):Promise.resolve(),trigger:"change"}],nickname:[{validator:async(a,t)=>t===""?Promise.reject("Please input the nickname"):t.length>20?Promise.reject("请输入小于长度为20的昵称"):Promise.resolve(),trigger:"change"}]},h=async()=>{await _.push({name:"entrance",params:{operate:"login"}}),await u("clickSignUp")},w=async()=>{var t;console.log(s);const{data:a}=await G(s.email);if(a.message=="error")P.warning("该邮箱已被注册！"),(t=r.value)==null||t.resetFields();else{const{data:l}=await H(Object.assign(s,{user_id:J(8),coverimg:""}));l.message=="success"&&(P.success("成功注册"),h())}},c=()=>{};return(a,t)=>{const l=d("a-input"),m=d("a-form-item"),x=d("a-button"),p=d("a-form");return j(),R("div",null,[e("div",oe,[e("div",ne,[re,o(p,{class:"form",model:s,rules:k,ref_key:"formRef",ref:r,name:"custom-validation",onFinish:w,onFinishFailed:c},{default:i(()=>[e("div",null,[ie,o(m,{name:"email","has-feedback":""},{default:i(()=>[o(l,{value:s.email,"onUpdate:value":t[0]||(t[0]=g=>s.email=g),type:"text",placeholder:"请输入邮箱"},null,8,["value"])]),_:1})]),e("div",null,[le,o(m,{name:"password","has-feedback":"",ref_key:"formRef",ref:r},{default:i(()=>[o(l,{value:s.password,"onUpdate:value":t[1]||(t[1]=g=>s.password=g),type:"",placeholder:"请输入最大长度为30的密码"},null,8,["value"])]),_:1},512)]),e("div",null,[ce,o(m,{name:"nickname","has-feedback":""},{default:i(()=>[o(l,{value:s.nickname,"onUpdate:value":t[2]||(t[2]=g=>s.nickname=g),type:"text",placeholder:"请输入最大长度为30的密码"},null,8,["value"])]),_:1})]),o(x,{type:"primary","html-type":"submit"},{default:i(()=>[y("Sign Up")]),_:1}),e("span",{class:"login-left-lastSpan"},[y("Does exist the account? "),e("a",{onClick:h},"Sign in")])]),_:1},8,["model"])]),de])])}}});const _e=$(ue,[["__scopeId","data-v-83885e91"]]),me={class:"login-regi-root"},pe=S({__name:"index",setup(n){const u=b(),r=N(u.currentRoute.value.params.operate),_=()=>{r.value=="login"?r.value="register":r.value="login"};return(s,F)=>(j(),R("div",me,[o(E,{name:"login"},{default:i(()=>[I(o(ae,{onClickSignUp:_},null,512),[[C,r.value=="login"]])]),_:1}),o(E,{name:"regi"},{default:i(()=>[I(o(_e,{onClickSignUp:_},null,512),[[C,r.value=="register"]])]),_:1})]))}});const ye=$(pe,[["__scopeId","data-v-12dce943"]]);export{ye as default};
